@host = http://localhost:8181

###
GET {{host}}/v1/policies
content-type: application/json

###
POST {{host}}/v1/data/http/allow HTTP/1.1
content-type: application/json

{
    "input": {
        "token": "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IjM5N0E4MEY2NTBBMUNFODhCMkVFOEM1ODk4M0MwQjBCIiwidHlwIjoiYXQrand0In0.eyJpc3MiOiJodHRwczovL2xvY2FsaG9zdDo1MDAxIiwibmJmIjoxNjQwMTQ5ODMwLCJpYXQiOjE2NDAxNDk4MzAsImV4cCI6MTY0MDE1MzQzMCwiYXVkIjpbInNhbGUtYXBpIiwiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMS9yZXNvdXJjZXMiXSwic2NvcGUiOlsic2FsZS5yZWFkIl0sImFtciI6WyJ1cm46aWV0ZjpwYXJhbXM6b2F1dGg6Z3JhbnQtdHlwZTp0b2tlbi1leGNoYW5nZSIsInB3ZCJdLCJjbGllbnRfaWQiOiJndy1hcGkiLCJzdWIiOiI4ODQyMTExMyIsImF1dGhfdGltZSI6MTY0MDE0OTgzMCwiaWRwIjoibG9jYWwiLCJqdGkiOiJFQkZDNzY3M0E0RjczQkNERTgwQUJDM0VFOERCMEU1NSJ9.HM7wHI5YtAFcJ4b7mAJoUUOO4rPInpK8vL5dTe02szYdmtc6NsKW1CC_NXUpq7jypCtdyxeYJtJ_rYDaLqk107RGFDa6qTrNlVCVm_z2FP3DelYPdUSbniicbkQnJvY1sUnUIopAiVeBH5lPpvrzvb6oAKuO1sXhA1cZ_mLsbgKh_OH582WxwZa912LZy4WH5yK2Xbk0iJROluJHwyiqPDX_KL5umU32-XemrfX8eDeNd8MzGN5BS9LgYda58RMEN8WbJW-bXvC1LWj6lsXWqK2aq1ePdIOsgREx6BYFewYhwTIS83D43FCaFcA_bADebUt3FS9tMdZ2u5WTQl_zNQ",
        "method": "GET",
        "path": ["api", "88421113"]
    }
}

###
POST {{host}}/v1/data/http/product_api_allow HTTP/1.1
content-type: application/json

{
    "input": {
        "token": "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IjM5N0E4MEY2NTBBMUNFODhCMkVFOEM1ODk4M0MwQjBCIiwidHlwIjoiYXQrand0In0.eyJpc3MiOiJodHRwczovL2xvY2FsaG9zdDo1MDAxIiwibmJmIjoxNjQwMTQ5ODMwLCJpYXQiOjE2NDAxNDk4MzAsImV4cCI6MTY0MDE1MzQzMCwiYXVkIjpbInNhbGUtYXBpIiwiaHR0cHM6Ly9sb2NhbGhvc3Q6NTAwMS9yZXNvdXJjZXMiXSwic2NvcGUiOlsic2FsZS5yZWFkIl0sImFtciI6WyJ1cm46aWV0ZjpwYXJhbXM6b2F1dGg6Z3JhbnQtdHlwZTp0b2tlbi1leGNoYW5nZSIsInB3ZCJdLCJjbGllbnRfaWQiOiJndy1hcGkiLCJzdWIiOiI4ODQyMTExMyIsImF1dGhfdGltZSI6MTY0MDE0OTgzMCwiaWRwIjoibG9jYWwiLCJqdGkiOiJFQkZDNzY3M0E0RjczQkNERTgwQUJDM0VFOERCMEU1NSJ9.HM7wHI5YtAFcJ4b7mAJoUUOO4rPInpK8vL5dTe02szYdmtc6NsKW1CC_NXUpq7jypCtdyxeYJtJ_rYDaLqk107RGFDa6qTrNlVCVm_z2FP3DelYPdUSbniicbkQnJvY1sUnUIopAiVeBH5lPpvrzvb6oAKuO1sXhA1cZ_mLsbgKh_OH582WxwZa912LZy4WH5yK2Xbk0iJROluJHwyiqPDX_KL5umU32-XemrfX8eDeNd8MzGN5BS9LgYda58RMEN8WbJW-bXvC1LWj6lsXWqK2aq1ePdIOsgREx6BYFewYhwTIS83D43FCaFcA_bADebUt3FS9tMdZ2u5WTQl_zNQ",
        "method": "GET",
        "path": ["api", "products"]
    }
}

###
POST {{host}}/v1/data HTTP/1.1
Content-Type: application/json

{
    "input": {
        "request": {
            "headers": {
                "Authorization": "bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik1yNS1BVWliZkJpaTdOZDFqQmViYXhib1hXMCIsImtpZCI6Ik1yNS1BVWliZkJpaTdOZDFqQmViYXhib1hXMCJ9.eyJhdWQiOiJhcGk6Ly85ZDZlYTA3MS04MzkwLTQ0NDgtYjdkYS04MWRkNzRhZjNlZjgiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC81ODk3MDhlOC1iMzA0LTQyYjQtYjJlOS0wYTZjY2VkMmRkZjEvIiwiaWF0IjoxNjM5NzMzOTA1LCJuYmYiOjE2Mzk3MzM5MDUsImV4cCI6MTYzOTczNzIyNiwiYWNyIjoiMCIsImFpbyI6IkFUUUF5LzhUQUFBQVdaTG9zSjdVZHhZdzhtTEtqeThhUVhNeUFIOCthVEsrbU8rVlM1YStXQVIzSDV5Q3pzV2tkZ3JaZkd0ZmU3clEiLCJhbXIiOlsicHdkIl0sImFwcGlkIjoiMzlhZDhiZWUtMTIxZC00MGJkLTgyYWMtMmNiZjdkOGI4MGY1IiwiYXBwaWRhY3IiOiIxIiwiZmFtaWx5X25hbWUiOiJTdXBlckFEMTIzIiwiZ2l2ZW5fbmFtZSI6IlN1cGVyIiwiaXBhZGRyIjoiMjAzLjIwNS4yOC43NiIsIm5hbWUiOiJTdXBlciBTdXBlckFEMTIzIiwib2lkIjoiNDgyZDA5ZTEtYWU3ZC00YzE0LTkzMmEtNmQ1ODExNDE2YWM2IiwicmgiOiIwLkFWQUE2QWlYV0FTenRFS3k2UXBzenRMZDhlNkxyVGtkRXIxQWdxd3N2MzJMZ1BWUUFMNC4iLCJyb2xlcyI6WyI0MzI2ZGQ5Ni0xYjAzLTRkNDAtODgyZS1iZDA2NmIzZTNkNDMiXSwic2NwIjoiYWNjZXNzX2FzX3VzZXIgdXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoiTklxbWdaTThrVVIxeXlkMUdjeWRuLVpHV3BzOXNFZTNzUkh4Ynpmd2djZyIsInRpZCI6IjU4OTcwOGU4LWIzMDQtNDJiNC1iMmU5LTBhNmNjZWQyZGRmMSIsInVuaXF1ZV9uYW1lIjoic3VwZXJAczVlbGFiLm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6InN1cGVyQHM1ZWxhYi5vbm1pY3Jvc29mdC5jb20iLCJ1dGkiOiJZSjhyd0JCWDlrNmVWOWNfZ3dKZEFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXX0.SQlHKQXsFn5akWFtrq_qW9vaUMOYRUrEsgfOOpuyfGTDUi9CC_iZpJuLSyuGNJHV84mRUVWGLkllaqUePdjC73nJRmde6Pm1qPMM7_JtobqnR-RJwaSBPlKiXJf8tyzcXojrRKzvrjH1BlOl-xqxwLDBYAL1tPQCzrwLNobmSwclrX0_10wTVOSh84dK1HSG9OARfzDjnxFCOIQ6WQ-Mhk5JdMfo4PMdgqE89nQGX-MT-kfOUqgzCgXeKrAU0SmgXDDlv0aHk18Z2vf1ghlvn-X3U710DfvCRWeF2fLCT840GsbtgTKLtB7gazQ56qHey03P2L76uE0ovmJ7i0WwRg"
            }
        }
    }
}

###
@token = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik1yNS1BVWliZkJpaTdOZDFqQmViYXhib1hXMCIsImtpZCI6Ik1yNS1BVWliZkJpaTdOZDFqQmViYXhib1hXMCJ9.eyJhdWQiOiJhcGk6Ly85ZDZlYTA3MS04MzkwLTQ0NDgtYjdkYS04MWRkNzRhZjNlZjgiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC81ODk3MDhlOC1iMzA0LTQyYjQtYjJlOS0wYTZjY2VkMmRkZjEvIiwiaWF0IjoxNjM5NzMzOTA1LCJuYmYiOjE2Mzk3MzM5MDUsImV4cCI6MTYzOTczNzIyNiwiYWNyIjoiMCIsImFpbyI6IkFUUUF5LzhUQUFBQVdaTG9zSjdVZHhZdzhtTEtqeThhUVhNeUFIOCthVEsrbU8rVlM1YStXQVIzSDV5Q3pzV2tkZ3JaZkd0ZmU3clEiLCJhbXIiOlsicHdkIl0sImFwcGlkIjoiMzlhZDhiZWUtMTIxZC00MGJkLTgyYWMtMmNiZjdkOGI4MGY1IiwiYXBwaWRhY3IiOiIxIiwiZmFtaWx5X25hbWUiOiJTdXBlckFEMTIzIiwiZ2l2ZW5fbmFtZSI6IlN1cGVyIiwiaXBhZGRyIjoiMjAzLjIwNS4yOC43NiIsIm5hbWUiOiJTdXBlciBTdXBlckFEMTIzIiwib2lkIjoiNDgyZDA5ZTEtYWU3ZC00YzE0LTkzMmEtNmQ1ODExNDE2YWM2IiwicmgiOiIwLkFWQUE2QWlYV0FTenRFS3k2UXBzenRMZDhlNkxyVGtkRXIxQWdxd3N2MzJMZ1BWUUFMNC4iLCJyb2xlcyI6WyI0MzI2ZGQ5Ni0xYjAzLTRkNDAtODgyZS1iZDA2NmIzZTNkNDMiXSwic2NwIjoiYWNjZXNzX2FzX3VzZXIgdXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoiTklxbWdaTThrVVIxeXlkMUdjeWRuLVpHV3BzOXNFZTNzUkh4Ynpmd2djZyIsInRpZCI6IjU4OTcwOGU4LWIzMDQtNDJiNC1iMmU5LTBhNmNjZWQyZGRmMSIsInVuaXF1ZV9uYW1lIjoic3VwZXJAczVlbGFiLm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6InN1cGVyQHM1ZWxhYi5vbm1pY3Jvc29mdC5jb20iLCJ1dGkiOiJZSjhyd0JCWDlrNmVWOWNfZ3dKZEFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXX0.SQlHKQXsFn5akWFtrq_qW9vaUMOYRUrEsgfOOpuyfGTDUi9CC_iZpJuLSyuGNJHV84mRUVWGLkllaqUePdjC73nJRmde6Pm1qPMM7_JtobqnR-RJwaSBPlKiXJf8tyzcXojrRKzvrjH1BlOl-xqxwLDBYAL1tPQCzrwLNobmSwclrX0_10wTVOSh84dK1HSG9OARfzDjnxFCOIQ6WQ-Mhk5JdMfo4PMdgqE89nQGX-MT-kfOUqgzCgXeKrAU0SmgXDDlv0aHk18Z2vf1ghlvn-X3U710DfvCRWeF2fLCT840GsbtgTKLtB7gazQ56qHey03P2L76uE0ovmJ7i0WwRg'
POST {{host}}/v1/data/httpapi/authz HTTP/1.1
content-type: application/json

{
    "input": {
        "path": ["finance", "salary", "alice"],
        "user": "alice",
        "method": "GET",
        "authorization": "Bearer {{token}}"
    }
}